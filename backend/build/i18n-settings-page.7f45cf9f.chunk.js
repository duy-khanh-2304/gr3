"use strict";(self.webpackChunklab_nckh=self.webpackChunklab_nckh||[]).push([[3552],{72751:(Ue,b,t)=>{t.r(b),t.d(b,{default:()=>Ge});var e=t(67294),u=t(79946),le=t(45697),c=t.n(le),v=t(86896),ne=t(57713),se=t(79371),L=t(19442),oe=t(26789),ie=t(81391),I=t(12978),ce=t(58252),z=t(8181),s=t(57813),C=t(41054),V=t(8675),G=t(60881),H=t(18189),E=t(77270),U=t(48683),W=t(20107),T=t(75878),S=t(61738),j=t(81984),Q=t(50781),M=t(54375),X=t(45124),F=t(87561);const $=(0,F.Ry)().shape({code:(0,F.Z_)().required(),displayName:(0,F.Z_)().max(50,"Settings.locales.modal.locales.displayName.error").required(u.translatedErrors.required)});var x=t(86706),N=t(7982);const de=()=>{const[l,n]=(0,e.useState)(!1),o=(0,x.I0)(),a=(0,u.useNotification)(),{put:i}=(0,u.useFetchClient)();return{isEditing:l,editLocale:async(r,m)=>{try{n(!0);const{data:g}=await i(`/i18n/locales/${r}`,m);a({type:"success",message:{id:(0,s.O)("Settings.locales.modal.edit.success")}}),o({type:N.OT,editedLocale:g})}catch{a({type:"warning",message:{id:"notification.error"}})}finally{n(!1)}}}};var J=t(9370),D=t(61585),re=t(50614),me=t(473),K=t(28469),ue=t(88767),ge=t(46683);const Y=()=>{const{formatMessage:l}=(0,v.Z)(),{notifyStatus:n}=(0,ge.G)(),o=(0,u.useNotification)(),{get:a}=(0,u.useFetchClient)(),{isLoading:i,data:d}=(0,ue.useQuery)(["plugin-i18n","locales"],async()=>{try{const{data:r}=await a("/i18n/iso-locales");return n(l({id:(0,s.O)("Settings.locales.modal.locales.loaded"),defaultMessage:"The locales have been successfully loaded."})),r}catch{return o({type:"warning",message:{id:"notification.error"}}),[]}});return{defaultLocales:d,isLoading:i}},k=({locale:l})=>{const{formatMessage:n}=(0,v.Z)(),{values:o,handleChange:a,errors:i}=(0,C.useFormikContext)(),{defaultLocales:d,isLoading:r}=Y(),m=!r&&d.find(g=>g.code===l.code);return e.createElement(J.r,{gap:4},e.createElement(D.P,{col:6},e.createElement(re.P,{label:n({id:(0,s.O)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:m?.code||l.code,disabled:!0},e.createElement(me.W,{value:m?.code||l.code},m?.name||l.code))),e.createElement(D.P,{col:6},e.createElement(K.o,{name:"displayName",label:n({id:(0,s.O)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:n({id:(0,s.O)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?n({id:(0,s.O)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:o.displayName,onChange:a})))},fe=k;k.propTypes={locale:c().shape({id:c().number.isRequired,name:c().string.isRequired,code:c().string.isRequired,isDefault:c().bool.isRequired}).isRequired};var w=t(13539);const q=({isDefaultLocale:l})=>{const{values:n,setFieldValue:o}=(0,C.useFormikContext)(),{formatMessage:a}=(0,v.Z)();return e.createElement(w.X,{name:"isDefault",hint:a({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>o("isDefault",!n.isDefault),value:n.isDefault,disabled:l},a({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"}))};q.propTypes={isDefaultLocale:c().bool.isRequired};const ve=q,Z=({locale:l,onClose:n})=>{const{refetchPermissions:o}=(0,u.useRBACProvider)(),{isEditing:a,editLocale:i}=de(),{formatMessage:d}=(0,v.Z)(),r=async({displayName:m,isDefault:g})=>{await i(l.id,{name:m,isDefault:g}),await o()};return e.createElement(G.P,{onClose:n,labelledBy:"edit-locale-title"},e.createElement(C.Formik,{initialValues:{code:l?.code,displayName:l?.name||"",isDefault:Boolean(l?.isDefault)},onSubmit:r,validationSchema:$},e.createElement(u.Form,null,e.createElement(H.x,null,e.createElement(E.Z,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"edit-locale-title"},d({id:(0,s.O)("Settings.list.actions.edit"),defaultMessage:"Edit a locale"}))),e.createElement(U.f,null,e.createElement(W.v,{label:d({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple"},e.createElement(T.k,{justifyContent:"space-between"},e.createElement(E.Z,{as:"h2"},d({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"})),e.createElement(S.m,null,e.createElement(S.O,null,d({id:(0,s.O)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})),e.createElement(S.O,null,d({id:(0,s.O)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})))),e.createElement(j.i,null),e.createElement(Q.x,{paddingTop:7,paddingBottom:7},e.createElement(M.n,null,e.createElement(M.x,null,e.createElement(fe,{locale:l})),e.createElement(M.x,null,e.createElement(ve,{isDefaultLocale:Boolean(l&&l.isDefault)})))))),e.createElement(X.m,{startActions:e.createElement(L.z,{variant:"tertiary",onClick:n},d({id:"app.components.Button.cancel"})),endActions:e.createElement(L.z,{type:"submit",startIcon:e.createElement(V.Z,null),disabled:a},d({id:"global.save"}))}))))};Z.defaultProps={locale:void 0},Z.propTypes={locale:c().shape({id:c().number.isRequired,name:c().string.isRequired,code:c().string.isRequired,isDefault:c().bool.isRequired}),onClose:c().func.isRequired};const Ee=Z,he=()=>{const[l,n]=(0,e.useState)(!1),o=(0,x.I0)(),a=(0,u.useNotification)(),{del:i}=(0,u.useFetchClient)();return{isDeleting:l,deleteLocale:async r=>{try{n(!0),await i(`/i18n/locales/${r}`),a({type:"success",message:{id:(0,s.O)("Settings.locales.modal.delete.success")}}),o({type:N.HC,id:r})}catch{a({type:"warning",message:{id:"notification.error"}})}finally{n(!1)}}}},A=({localeToDelete:l,onClose:n})=>{const{isDeleting:o,deleteLocale:a}=he(),i=Boolean(l),d=()=>a(l.id).then(n);return e.createElement(u.ConfirmDialog,{isConfirmButtonLoading:o,onConfirm:d,onToggleDialog:n,isOpen:i})};A.defaultProps={localeToDelete:void 0},A.propTypes={localeToDelete:c().shape({id:c().number.isRequired}),onClose:c().func.isRequired};const ye=A;var pe=t(27361),Le=t.n(pe);const Ce=()=>{const[l,n]=(0,e.useState)(!1),o=(0,x.I0)(),a=(0,u.useNotification)(),{post:i}=(0,u.useFetchClient)();return{isAdding:l,addLocale:async r=>{n(!0);try{const{data:m}=await i("/i18n/locales",r);a({type:"success",message:{id:(0,s.O)("Settings.locales.modal.create.success")}}),o({type:N.xz,newLocale:m})}catch(m){const g=Le()(m,"response.payload.message",null);throw g&&g.includes("already exists")?a({type:"warning",message:{id:(0,s.O)("Settings.locales.modal.create.alreadyExist")}}):a({type:"warning",message:{id:"notification.error"}}),m}finally{n(!1)}}}};var Se=t(63122),Me=t(85612);const R=e.memo(({value:l,onClear:n,onLocaleChange:o,error:a})=>{const{formatMessage:i}=(0,v.Z)(),{defaultLocales:d,isLoading:r}=Y(),{locales:m}=(0,z.Z)(),g=(d||[]).map(f=>({label:f.name,value:f.code})).filter(({value:f})=>{const y=m.find(({code:O})=>O===f);return!y||y.code===l}),p=l||"";return e.createElement(Se.hQ,{"aria-busy":r,error:a,label:i({id:(0,s.O)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:p,onClear:l?n:void 0,onChange:f=>{const y=g.find(O=>O.value===f);y&&o({code:y.value,displayName:y.label})},placeholder:i({id:"components.placeholder.select",defaultMessage:"Select"})},g.map(f=>e.createElement(Me.O,{value:f.value,key:f.value},f.label)))});R.defaultProps={error:void 0,value:void 0,onClear(){},onLocaleChange:()=>{}},R.propTypes={error:c().string,onClear:c().func,onLocaleChange:c().func,value:c().string};const Oe=R,De=()=>{const{formatMessage:l}=(0,v.Z)(),{values:n,handleChange:o,setFieldValue:a,errors:i}=(0,C.useFormikContext)(),d=(0,e.useCallback)(m=>{a("displayName",m.displayName),a("code",m.code)},[a]),r=(0,e.useCallback)(()=>{a("displayName",""),a("code","")},[a]);return e.createElement(J.r,{gap:4},e.createElement(D.P,{col:6},e.createElement(Oe,{error:i.code,value:n.code,onLocaleChange:d,onClear:r})),e.createElement(D.P,{col:6},e.createElement(K.o,{name:"displayName",label:l({id:(0,s.O)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:l({id:(0,s.O)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?l({id:(0,s.O)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:n.displayName,onChange:o})))},Te=()=>{const{values:l,setFieldValue:n}=(0,C.useFormikContext)(),{formatMessage:o}=(0,v.Z)();return e.createElement(w.X,{hint:o({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>n("isDefault",!l.isDefault),value:l.isDefault},o({id:(0,s.O)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"}))},Fe={code:"",displayName:"",isDefault:!1},_=({onClose:l})=>{const{isAdding:n,addLocale:o}=Ce(),{formatMessage:a}=(0,v.Z)(),{refetchPermissions:i}=(0,u.useRBACProvider)(),d=async r=>{await o({code:r.code,name:r.displayName,isDefault:r.isDefault}),await i()};return e.createElement(G.P,{onClose:l,labelledBy:"add-locale-title"},e.createElement(C.Formik,{initialValues:Fe,onSubmit:d,validationSchema:$,validateOnChange:!1},e.createElement(u.Form,null,e.createElement(H.x,null,e.createElement(E.Z,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"add-locale-title"},a({id:(0,s.O)("Settings.list.actions.add"),defaultMessage:"Add new locale"}))),e.createElement(U.f,null,e.createElement(W.v,{label:a({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple"},e.createElement(T.k,{justifyContent:"space-between"},e.createElement(E.Z,{as:"h2",variant:"beta"},a({id:(0,s.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"})),e.createElement(S.m,null,e.createElement(S.O,null,a({id:(0,s.O)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})),e.createElement(S.O,null,a({id:(0,s.O)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})))),e.createElement(j.i,null),e.createElement(Q.x,{paddingTop:7,paddingBottom:7},e.createElement(M.n,null,e.createElement(M.x,null,e.createElement(De,null)),e.createElement(M.x,null,e.createElement(Te,null)))))),e.createElement(X.m,{startActions:e.createElement(L.z,{variant:"tertiary",onClick:l},a({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(L.z,{type:"submit",startIcon:e.createElement(V.Z,null),disabled:n},a({id:"global.save",defaultMessage:"Save"}))}))))};_.propTypes={onClose:c().func.isRequired};const xe=_;var Ne=t(51541),Ze=t(42403),ee=t(6090),h=t(62351),Ae=t(22996),Re=t(94487),te=t(37527),Be=t(36670),Pe=t(34263);const B=({locales:l,onDeleteLocale:n,onEditLocale:o})=>{const{formatMessage:a}=(0,v.Z)();return e.createElement(Ne.i,{colCount:4,rowCount:l.length+1},e.createElement(Ze.h,null,e.createElement(ee.Tr,null,e.createElement(h.Th,null,e.createElement(E.Z,{variant:"sigma",textColor:"neutral600"},a({id:(0,s.O)("Settings.locales.row.id")}))),e.createElement(h.Th,null,e.createElement(E.Z,{variant:"sigma",textColor:"neutral600"},a({id:(0,s.O)("Settings.locales.row.displayName")}))),e.createElement(h.Th,null,e.createElement(E.Z,{variant:"sigma",textColor:"neutral600"},a({id:(0,s.O)("Settings.locales.row.default-locale")}))),e.createElement(h.Th,null,e.createElement(Ae.T,null,"Actions")))),e.createElement(Re.p,null,l.map(i=>e.createElement(ee.Tr,{key:i.id,...(0,u.onRowClick)({fn:()=>o(i),condition:o})},e.createElement(h.Td,null,e.createElement(E.Z,{textColor:"neutral800"},i.id)),e.createElement(h.Td,null,e.createElement(E.Z,{textColor:"neutral800"},i.name)),e.createElement(h.Td,null,e.createElement(E.Z,{textColor:"neutral800"},i.isDefault?a({id:(0,s.O)("Settings.locales.default")}):null)),e.createElement(h.Td,null,e.createElement(T.k,{gap:1,justifyContent:"flex-end",...u.stopPropagation},o&&e.createElement(te.h,{onClick:()=>o(i),label:a({id:(0,s.O)("Settings.list.actions.edit")}),icon:e.createElement(Be.Z,null),noBorder:!0}),n&&!i.isDefault&&e.createElement(te.h,{onClick:()=>n(i),label:a({id:(0,s.O)("Settings.list.actions.delete")}),icon:e.createElement(Pe.Z,null),noBorder:!0})))))))};B.defaultProps={locales:[],onDeleteLocale:void 0,onEditLocale:void 0},B.propTypes={locales:c().array,onDeleteLocale:c().func,onEditLocale:c().func};const be=B,P=({canUpdateLocale:l,canDeleteLocale:n,onToggleCreateModal:o,isCreating:a})=>{const[i,d]=(0,e.useState)(),[r,m]=(0,e.useState)(),{locales:g}=(0,z.Z)(),{formatMessage:p}=(0,v.Z)();(0,u.useFocusWhenNavigate)();const f=()=>d(void 0),y=n?d:void 0,O=()=>m(void 0),He=l?m:void 0;return e.createElement(ne.o,{tabIndex:-1},e.createElement(se.T,{primaryAction:e.createElement(L.z,{startIcon:e.createElement(I.Z,null),onClick:o,size:"S"},p({id:(0,s.O)("Settings.list.actions.add")})),title:p({id:(0,s.O)("plugin.name")}),subtitle:p({id:(0,s.O)("Settings.list.description")})}),e.createElement(oe.D,null,g?.length>0?e.createElement(be,{locales:g,onDeleteLocale:y,onEditLocale:He}):e.createElement(ie.x,{icon:e.createElement(ce.Z,{width:void 0,height:void 0}),content:p({id:(0,s.O)("Settings.list.empty.title")}),action:o?e.createElement(L.z,{variant:"secondary",startIcon:e.createElement(I.Z,null),onClick:o},p({id:(0,s.O)("Settings.list.actions.add")})):null})),a&&e.createElement(xe,{onClose:o}),r&&e.createElement(Ee,{onClose:O,locale:r}),e.createElement(ye,{localeToDelete:i,onClose:f}))};P.defaultProps={onToggleCreateModal:void 0},P.propTypes={canUpdateLocale:c().bool.isRequired,canDeleteLocale:c().bool.isRequired,onToggleCreateModal:c().func,isCreating:c().bool.isRequired};const Ie=P,ae=({canReadLocale:l,canCreateLocale:n,canDeleteLocale:o,canUpdateLocale:a})=>{const[i,d]=(0,e.useState)(!1),r=n?()=>d(m=>!m):void 0;return l?e.createElement(Ie,{canUpdateLocale:a,canDeleteLocale:o,onToggleCreateModal:r,isCreating:i}):null};ae.propTypes={canReadLocale:c().bool.isRequired,canCreateLocale:c().bool.isRequired,canUpdateLocale:c().bool.isRequired,canDeleteLocale:c().bool.isRequired};const ze=ae;var Ve=t(2135);const Ge=()=>{const{isLoading:l,allowedActions:{canRead:n,canUpdate:o,canCreate:a,canDelete:i}}=(0,u.useRBAC)(Ve.Z);return l?null:e.createElement(ze,{canReadLocale:n,canCreateLocale:a,canUpdateLocale:o,canDeleteLocale:i})}}}]);
